<?xml version="1.0" encoding="UTF-8"?>
<coveredFile fullPath="/home/manu/Desktop/Projects/workspace.xplib.de/phpUnderControl/trunk//lib/ezc/Base/src/base.php" shortenedPath="lib/ezc/Base/src/base.php" generated="1212932774" phpunit="@package_version@">
  <line lineNumber="1" executed="-3">
    <body><![CDATA[<?php]]></body>
  </line>
  <line lineNumber="2" executed="-3">
    <body><![CDATA[/**]]></body>
  </line>
  <line lineNumber="3" executed="-3">
    <body><![CDATA[ * File containing the ezcBase class.]]></body>
  </line>
  <line lineNumber="4" executed="-3">
    <body><![CDATA[ *]]></body>
  </line>
  <line lineNumber="5" executed="-3">
    <body><![CDATA[ * @package Base]]></body>
  </line>
  <line lineNumber="6" executed="-3">
    <body><![CDATA[ * @version 1.4.1]]></body>
  </line>
  <line lineNumber="7" executed="-3">
    <body><![CDATA[ * @copyright Copyright (C) 2005-2008 eZ systems as. All rights reserved.]]></body>
  </line>
  <line lineNumber="8" executed="-3">
    <body><![CDATA[ * @license http://ez.no/licenses/new_bsd New BSD License]]></body>
  </line>
  <line lineNumber="9" executed="-3">
    <body><![CDATA[ */]]></body>
  </line>
  <line lineNumber="10" executed="-3">
    <body><![CDATA[/**]]></body>
  </line>
  <line lineNumber="11" executed="-3">
    <body><![CDATA[ * Base class implements the methods needed to use the eZ components.]]></body>
  </line>
  <line lineNumber="12" executed="-3">
    <body><![CDATA[ *]]></body>
  </line>
  <line lineNumber="13" executed="-3">
    <body><![CDATA[ * @package Base]]></body>
  </line>
  <line lineNumber="14" executed="-3">
    <body><![CDATA[ * @version 1.4.1]]></body>
  </line>
  <line lineNumber="15" executed="-3">
    <body><![CDATA[ * @mainclass]]></body>
  </line>
  <line lineNumber="16" executed="-3">
    <body><![CDATA[ */]]></body>
  </line>
  <line lineNumber="17" executed="-3">
    <body><![CDATA[class ezcBase]]></body>
  </line>
  <line lineNumber="18" executed="-3">
    <body><![CDATA[{]]></body>
  </line>
  <line lineNumber="19" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="20" executed="-3">
    <body><![CDATA[     * Used for dependency checking, to check for a PHP extension.]]></body>
  </line>
  <line lineNumber="21" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="22" executed="-3">
    <body><![CDATA[    const DEP_PHP_EXTENSION = "extension";]]></body>
  </line>
  <line lineNumber="23" executed="-3">
    <body></body>
  </line>
  <line lineNumber="24" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="25" executed="-3">
    <body><![CDATA[     * Used for dependency checking, to check for a PHP version.]]></body>
  </line>
  <line lineNumber="26" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="27" executed="-3">
    <body><![CDATA[    const DEP_PHP_VERSION = "version";]]></body>
  </line>
  <line lineNumber="28" executed="-3">
    <body><![CDATA[    ]]></body>
  </line>
  <line lineNumber="29" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="30" executed="-3">
    <body><![CDATA[     * Indirectly it determines the path where the autoloads are stored.]]></body>
  </line>
  <line lineNumber="31" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="32" executed="-3">
    <body><![CDATA[     * @var string]]></body>
  </line>
  <line lineNumber="33" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="34" executed="-3">
    <body><![CDATA[    private static $libraryMode = "devel";]]></body>
  </line>
  <line lineNumber="35" executed="-3">
    <body></body>
  </line>
  <line lineNumber="36" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="37" executed="-3">
    <body><![CDATA[     * Contains the current working directory, which is used when the]]></body>
  </line>
  <line lineNumber="38" executed="-3">
    <body><![CDATA[     * $libraryMode is set to "custom".]]></body>
  </line>
  <line lineNumber="39" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="40" executed="-3">
    <body><![CDATA[     * @var string]]></body>
  </line>
  <line lineNumber="41" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="42" executed="-3">
    <body><![CDATA[    private static $currentWorkingDirectory = null;]]></body>
  </line>
  <line lineNumber="43" executed="-3">
    <body></body>
  </line>
  <line lineNumber="44" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="45" executed="-3">
    <body><![CDATA[     * The full path to the autoload directory.]]></body>
  </line>
  <line lineNumber="46" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="47" executed="-3">
    <body><![CDATA[     * @var string]]></body>
  </line>
  <line lineNumber="48" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="49" executed="-3">
    <body><![CDATA[    protected static $packageDir;]]></body>
  </line>
  <line lineNumber="50" executed="-3">
    <body></body>
  </line>
  <line lineNumber="51" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="52" executed="-3">
    <body><![CDATA[     * Stores info with additional paths where autoload files and classes for]]></body>
  </line>
  <line lineNumber="53" executed="-3">
    <body><![CDATA[     * autoloading could be found. Each item of $repositoryDirs looks like]]></body>
  </line>
  <line lineNumber="54" executed="-3">
    <body><![CDATA[     * array( autoloadFileDir, baseDir ). The array key is the prefix belonging]]></body>
  </line>
  <line lineNumber="55" executed="-3">
    <body><![CDATA[     * to classes within that repository - if provided when calling]]></body>
  </line>
  <line lineNumber="56" executed="-3">
    <body><![CDATA[     * addClassRepository(), or an autoincrement integer otherwise.]]></body>
  </line>
  <line lineNumber="57" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="58" executed="-3">
    <body><![CDATA[     * @var array(string=>array)]]></body>
  </line>
  <line lineNumber="59" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="60" executed="-3">
    <body><![CDATA[    protected static $repositoryDirs = array();]]></body>
  </line>
  <line lineNumber="61" executed="-3">
    <body></body>
  </line>
  <line lineNumber="62" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="63" executed="-3">
    <body><![CDATA[     * This variable stores all the elements from the autoload arrays. When a]]></body>
  </line>
  <line lineNumber="64" executed="-3">
    <body><![CDATA[     * new autoload file is loaded, their files are added to this array.]]></body>
  </line>
  <line lineNumber="65" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="66" executed="-3">
    <body><![CDATA[     * @var array(string=>string)]]></body>
  </line>
  <line lineNumber="67" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="68" executed="-3">
    <body><![CDATA[    protected static $autoloadArray = array();]]></body>
  </line>
  <line lineNumber="69" executed="-3">
    <body></body>
  </line>
  <line lineNumber="70" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="71" executed="-3">
    <body><![CDATA[     * This variable stores all the elements from the autoload arrays for]]></body>
  </line>
  <line lineNumber="72" executed="-3">
    <body><![CDATA[     * external repositories. When a new autoload file is loaded, their files]]></body>
  </line>
  <line lineNumber="73" executed="-3">
    <body><![CDATA[     * are added to this array.]]></body>
  </line>
  <line lineNumber="74" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="75" executed="-3">
    <body><![CDATA[     * @var array(string=>string)]]></body>
  </line>
  <line lineNumber="76" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="77" executed="-3">
    <body><![CDATA[    protected static $externalAutoloadArray = array();]]></body>
  </line>
  <line lineNumber="78" executed="-3">
    <body></body>
  </line>
  <line lineNumber="79" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="80" executed="-3">
    <body><![CDATA[     * Options for the ezcBase class.]]></body>
  </line>
  <line lineNumber="81" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="82" executed="-3">
    <body><![CDATA[     * @var ezcBaseOptions]]></body>
  </line>
  <line lineNumber="83" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="84" executed="-3">
    <body><![CDATA[    static private $options;]]></body>
  </line>
  <line lineNumber="85" executed="-3">
    <body></body>
  </line>
  <line lineNumber="86" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="87" executed="-3">
    <body><![CDATA[     * Associates an option object with this static class.]]></body>
  </line>
  <line lineNumber="88" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="89" executed="-3">
    <body><![CDATA[     * @param ezcBaseAutoloadOptions $options]]></body>
  </line>
  <line lineNumber="90" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="91" executed="-3">
    <body><![CDATA[    static public function setOptions( ezcBaseAutoloadOptions $options )]]></body>
  </line>
  <line lineNumber="92" executed="-3">
    <body><![CDATA[    {]]></body>
  </line>
  <line lineNumber="93" executed="-1">
    <body><![CDATA[        self::$options = $options;]]></body>
  </line>
  <line lineNumber="94" executed="-1">
    <body><![CDATA[    }]]></body>
  </line>
  <line lineNumber="95" executed="-3">
    <body></body>
  </line>
  <line lineNumber="96" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="97" executed="-3">
    <body><![CDATA[     * Tries to autoload the given className. If the className could be found]]></body>
  </line>
  <line lineNumber="98" executed="-3">
    <body><![CDATA[     * this method returns true, otherwise false.]]></body>
  </line>
  <line lineNumber="99" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="100" executed="-3">
    <body><![CDATA[     * This class caches the requested class names (including the ones who]]></body>
  </line>
  <line lineNumber="101" executed="-3">
    <body><![CDATA[     * failed to load).]]></body>
  </line>
  <line lineNumber="102" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="103" executed="-3">
    <body><![CDATA[     * @param string $className  The name of the class that should be loaded.]]></body>
  </line>
  <line lineNumber="104" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="105" executed="-3">
    <body><![CDATA[     * @return bool]]></body>
  </line>
  <line lineNumber="106" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="107" executed="-3">
    <body><![CDATA[    public static function autoload( $className )]]></body>
  </line>
  <line lineNumber="108" executed="-3">
    <body><![CDATA[    {]]></body>
  </line>
  <line lineNumber="109" executed="-1">
    <body><![CDATA[        ezcBase::setPackageDir();]]></body>
  </line>
  <line lineNumber="110" executed="-3">
    <body></body>
  </line>
  <line lineNumber="111" executed="-3">
    <body><![CDATA[        // Check whether the classname is already in the cached autoloadArray.]]></body>
  </line>
  <line lineNumber="112" executed="-1">
    <body><![CDATA[        if ( array_key_exists( $className, ezcBase::$autoloadArray ) )]]></body>
  </line>
  <line lineNumber="113" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="114" executed="-3">
    <body><![CDATA[            // Is it registered as 'unloadable'?]]></body>
  </line>
  <line lineNumber="115" executed="-1">
    <body><![CDATA[            if ( ezcBase::$autoloadArray[$className] == false )]]></body>
  </line>
  <line lineNumber="116" executed="-1">
    <body><![CDATA[            {]]></body>
  </line>
  <line lineNumber="117" executed="-1">
    <body><![CDATA[                return false;]]></body>
  </line>
  <line lineNumber="118" executed="-2">
    <body><![CDATA[            }]]></body>
  </line>
  <line lineNumber="119" executed="-1">
    <body><![CDATA[            ezcBase::loadFile( ezcBase::$autoloadArray[$className] );]]></body>
  </line>
  <line lineNumber="120" executed="-3">
    <body></body>
  </line>
  <line lineNumber="121" executed="-1">
    <body><![CDATA[            return true;]]></body>
  </line>
  <line lineNumber="122" executed="-2">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="123" executed="-3">
    <body><![CDATA[        ]]></body>
  </line>
  <line lineNumber="124" executed="-3">
    <body><![CDATA[        // Check whether the classname is already in the cached autoloadArray]]></body>
  </line>
  <line lineNumber="125" executed="-3">
    <body><![CDATA[        // for external repositories.]]></body>
  </line>
  <line lineNumber="126" executed="-1">
    <body><![CDATA[        if ( array_key_exists( $className, ezcBase::$externalAutoloadArray ) )]]></body>
  </line>
  <line lineNumber="127" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="128" executed="-3">
    <body><![CDATA[            // Is it registered as 'unloadable'?]]></body>
  </line>
  <line lineNumber="129" executed="-1">
    <body><![CDATA[            if ( ezcBase::$externalAutoloadArray[$className] == false )]]></body>
  </line>
  <line lineNumber="130" executed="-1">
    <body><![CDATA[            {]]></body>
  </line>
  <line lineNumber="131" executed="-1">
    <body><![CDATA[                return false;]]></body>
  </line>
  <line lineNumber="132" executed="-2">
    <body><![CDATA[            }]]></body>
  </line>
  <line lineNumber="133" executed="-1">
    <body><![CDATA[            ezcBase::loadExternalFile( ezcBase::$externalAutoloadArray[$className] );]]></body>
  </line>
  <line lineNumber="134" executed="-3">
    <body></body>
  </line>
  <line lineNumber="135" executed="-1">
    <body><![CDATA[            return true;]]></body>
  </line>
  <line lineNumber="136" executed="-2">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="137" executed="-3">
    <body></body>
  </line>
  <line lineNumber="138" executed="-3">
    <body><![CDATA[        // Not cached, so load the autoload from the package.]]></body>
  </line>
  <line lineNumber="139" executed="-3">
    <body><![CDATA[        // Matches the first and optionally the second 'word' from the classname.]]></body>
  </line>
  <line lineNumber="140" executed="-1">
    <body><![CDATA[        $fileNames = array();]]></body>
  </line>
  <line lineNumber="141" executed="-1">
    <body><![CDATA[        if ( preg_match( "/^([a-z0-9]*)([A-Z][a-z0-9]*)([A-Z][a-z0-9]*)?/", $className, $matches ) !== false )]]></body>
  </line>
  <line lineNumber="142" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="143" executed="-1">
    <body><![CDATA[            $autoloadFile = "";]]></body>
  </line>
  <line lineNumber="144" executed="-3">
    <body><![CDATA[            // Try to match with both names, if available.]]></body>
  </line>
  <line lineNumber="145" executed="-1">
    <body><![CDATA[            switch ( sizeof( $matches ) )]]></body>
  </line>
  <line lineNumber="146" executed="-3">
    <body><![CDATA[            {]]></body>
  </line>
  <line lineNumber="147" executed="-1">
    <body><![CDATA[                case 4:]]></body>
  </line>
  <line lineNumber="148" executed="-3">
    <body><![CDATA[                    // check for x_y_autoload.php]]></body>
  </line>
  <line lineNumber="149" executed="-1">
    <body><![CDATA[                    $autoloadFile = strtolower( "{$matches[2]}_{$matches[3]}_autoload.php" );]]></body>
  </line>
  <line lineNumber="150" executed="-1">
    <body><![CDATA[                    $fileNames[] = $autoloadFile;]]></body>
  </line>
  <line lineNumber="151" executed="-1">
    <body><![CDATA[                    if ( ezcBase::requireFile( $autoloadFile, $className, $matches[1] ) )]]></body>
  </line>
  <line lineNumber="152" executed="-1">
    <body><![CDATA[                    {]]></body>
  </line>
  <line lineNumber="153" executed="-1">
    <body><![CDATA[                        return true;]]></body>
  </line>
  <line lineNumber="154" executed="-2">
    <body><![CDATA[                    }]]></body>
  </line>
  <line lineNumber="155" executed="-3">
    <body><![CDATA[                    // break intentionally missing.]]></body>
  </line>
  <line lineNumber="156" executed="-3">
    <body></body>
  </line>
  <line lineNumber="157" executed="-1">
    <body><![CDATA[                case 3:]]></body>
  </line>
  <line lineNumber="158" executed="-3">
    <body><![CDATA[                    // check for x_autoload.php]]></body>
  </line>
  <line lineNumber="159" executed="-1">
    <body><![CDATA[                    $autoloadFile = strtolower( "{$matches[2]}_autoload.php" );]]></body>
  </line>
  <line lineNumber="160" executed="-1">
    <body><![CDATA[                    $fileNames[] = $autoloadFile;]]></body>
  </line>
  <line lineNumber="161" executed="-1">
    <body><![CDATA[                    if ( ezcBase::requireFile( $autoloadFile, $className, $matches[1] ) )]]></body>
  </line>
  <line lineNumber="162" executed="-1">
    <body><![CDATA[                    {]]></body>
  </line>
  <line lineNumber="163" executed="-1">
    <body><![CDATA[                        return true;]]></body>
  </line>
  <line lineNumber="164" executed="-2">
    <body><![CDATA[                    }]]></body>
  </line>
  <line lineNumber="165" executed="-3">
    <body></body>
  </line>
  <line lineNumber="166" executed="-3">
    <body><![CDATA[                    // check for autoload.php]]></body>
  </line>
  <line lineNumber="167" executed="-1">
    <body><![CDATA[                    $autoloadFile = 'autoload.php';]]></body>
  </line>
  <line lineNumber="168" executed="-1">
    <body><![CDATA[                    $fileNames[] = $autoloadFile;]]></body>
  </line>
  <line lineNumber="169" executed="-1">
    <body><![CDATA[                    if ( ezcBase::requireFile( $autoloadFile, $className, $matches[1] ) )]]></body>
  </line>
  <line lineNumber="170" executed="-1">
    <body><![CDATA[                    {]]></body>
  </line>
  <line lineNumber="171" executed="-1">
    <body><![CDATA[                        return true;]]></body>
  </line>
  <line lineNumber="172" executed="-2">
    <body><![CDATA[                    }]]></body>
  </line>
  <line lineNumber="173" executed="-1">
    <body><![CDATA[                    break;]]></body>
  </line>
  <line lineNumber="174" executed="-1">
    <body><![CDATA[            }]]></body>
  </line>
  <line lineNumber="175" executed="-3">
    <body></body>
  </line>
  <line lineNumber="176" executed="-3">
    <body><![CDATA[            // Maybe there is another autoload available.]]></body>
  </line>
  <line lineNumber="177" executed="-3">
    <body><![CDATA[            // Register this classname as false.]]></body>
  </line>
  <line lineNumber="178" executed="-1">
    <body><![CDATA[            ezcBase::$autoloadArray[$className] = false;]]></body>
  </line>
  <line lineNumber="179" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="180" executed="-3">
    <body></body>
  </line>
  <line lineNumber="181" executed="-1">
    <body><![CDATA[        $path = ezcBase::$packageDir . 'autoload/';]]></body>
  </line>
  <line lineNumber="182" executed="-1">
    <body><![CDATA[        $realPath = realpath( $path );]]></body>
  </line>
  <line lineNumber="183" executed="-3">
    <body></body>
  </line>
  <line lineNumber="184" executed="-1">
    <body><![CDATA[        if ( $realPath == '' )]]></body>
  </line>
  <line lineNumber="185" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="186" executed="-3">
    <body><![CDATA[            // Can not be tested, because if this happens, then the autoload]]></body>
  </line>
  <line lineNumber="187" executed="-3">
    <body><![CDATA[            // environment has not been set-up correctly. ]]></body>
  </line>
  <line lineNumber="188" executed="-1">
    <body><![CDATA[            trigger_error( "Couldn't find autoload directory '$path'", E_USER_ERROR );]]></body>
  </line>
  <line lineNumber="189" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="190" executed="-3">
    <body></body>
  </line>
  <line lineNumber="191" executed="-1">
    <body><![CDATA[        $dirs = self::getRepositoryDirectories();]]></body>
  </line>
  <line lineNumber="192" executed="-1">
    <body><![CDATA[        if ( ezcBase::$options && ezcBase::$options->debug )]]></body>
  </line>
  <line lineNumber="193" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="194" executed="-1">
    <body><![CDATA[            throw new ezcBaseAutoloadException( $className, $fileNames, $dirs );]]></body>
  </line>
  <line lineNumber="195" executed="-2">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="196" executed="-3">
    <body></body>
  </line>
  <line lineNumber="197" executed="-1">
    <body><![CDATA[        return false;]]></body>
  </line>
  <line lineNumber="198" executed="-2">
    <body><![CDATA[    }]]></body>
  </line>
  <line lineNumber="199" executed="-3">
    <body></body>
  </line>
  <line lineNumber="200" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="201" executed="-3">
    <body><![CDATA[     * Sets the current working directory to $directory.]]></body>
  </line>
  <line lineNumber="202" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="203" executed="-3">
    <body><![CDATA[     * @param string $directory]]></body>
  </line>
  <line lineNumber="204" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="205" executed="-3">
    <body><![CDATA[    public static function setWorkingDirectory( $directory )]]></body>
  </line>
  <line lineNumber="206" executed="-3">
    <body><![CDATA[    {]]></body>
  </line>
  <line lineNumber="207" executed="-1">
    <body><![CDATA[        self::$libraryMode = 'custom';]]></body>
  </line>
  <line lineNumber="208" executed="-1">
    <body><![CDATA[        self::$currentWorkingDirectory = $directory;]]></body>
  </line>
  <line lineNumber="209" executed="-1">
    <body><![CDATA[    }]]></body>
  </line>
  <line lineNumber="210" executed="-3">
    <body></body>
  </line>
  <line lineNumber="211" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="212" executed="-3">
    <body><![CDATA[     * Returns the path to the autoload directory. The path depends on]]></body>
  </line>
  <line lineNumber="213" executed="-3">
    <body><![CDATA[     * the installation of the ezComponents. The SVN version has different]]></body>
  </line>
  <line lineNumber="214" executed="-3">
    <body><![CDATA[     * paths than the PEAR installed version. (For now).]]></body>
  </line>
  <line lineNumber="215" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="216" executed="-3">
    <body><![CDATA[     * @return string]]></body>
  </line>
  <line lineNumber="217" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="218" executed="-3">
    <body><![CDATA[    protected static function setPackageDir()]]></body>
  </line>
  <line lineNumber="219" executed="-3">
    <body><![CDATA[    {]]></body>
  </line>
  <line lineNumber="220" executed="-3">
    <body><![CDATA[        // Get the path to the components.]]></body>
  </line>
  <line lineNumber="221" executed="-1">
    <body><![CDATA[        $baseDir = dirname( __FILE__ );]]></body>
  </line>
  <line lineNumber="222" executed="-3">
    <body></body>
  </line>
  <line lineNumber="223" executed="-1">
    <body><![CDATA[        switch ( ezcBase::$libraryMode )]]></body>
  </line>
  <line lineNumber="224" executed="-3">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="225" executed="-1">
    <body><![CDATA[            case "custom":]]></body>
  </line>
  <line lineNumber="226" executed="-1">
    <body><![CDATA[                ezcBase::$packageDir = self::$currentWorkingDirectory . '/';]]></body>
  </line>
  <line lineNumber="227" executed="-1">
    <body><![CDATA[                break;]]></body>
  </line>
  <line lineNumber="228" executed="-1">
    <body><![CDATA[            case "devel":]]></body>
  </line>
  <line lineNumber="229" executed="-1">
    <body><![CDATA[            case "tarball":]]></body>
  </line>
  <line lineNumber="230" executed="-1">
    <body><![CDATA[                ezcBase::$packageDir = $baseDir. "/../../";]]></body>
  </line>
  <line lineNumber="231" executed="-1">
    <body><![CDATA[                break;]]></body>
  </line>
  <line lineNumber="232" executed="-1">
    <body><![CDATA[            case "pear";]]></body>
  </line>
  <line lineNumber="233" executed="-1">
    <body><![CDATA[                ezcBase::$packageDir = $baseDir. "/../";]]></body>
  </line>
  <line lineNumber="234" executed="-1">
    <body><![CDATA[                break;]]></body>
  </line>
  <line lineNumber="235" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="236" executed="-1">
    <body><![CDATA[    }]]></body>
  </line>
  <line lineNumber="237" executed="-3">
    <body></body>
  </line>
  <line lineNumber="238" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="239" executed="-3">
    <body><![CDATA[     * Tries to load the autoload array and, if loaded correctly, includes the class.]]></body>
  </line>
  <line lineNumber="240" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="241" executed="-3">
    <body><![CDATA[     * @param string $fileName    Name of the autoload file.]]></body>
  </line>
  <line lineNumber="242" executed="-3">
    <body><![CDATA[     * @param string $className   Name of the class that should be autoloaded.]]></body>
  </line>
  <line lineNumber="243" executed="-3">
    <body><![CDATA[     * @param string $prefix      The prefix of the class repository.]]></body>
  </line>
  <line lineNumber="244" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="245" executed="-3">
    <body><![CDATA[     * @return bool  True is returned when the file is correctly loaded.]]></body>
  </line>
  <line lineNumber="246" executed="-3">
    <body><![CDATA[     *                   Otherwise false is returned.]]></body>
  </line>
  <line lineNumber="247" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="248" executed="-3">
    <body><![CDATA[    protected static function requireFile( $fileName, $className, $prefix )]]></body>
  </line>
  <line lineNumber="249" executed="-3">
    <body><![CDATA[    {]]></body>
  </line>
  <line lineNumber="250" executed="-1">
    <body><![CDATA[        $autoloadDir = ezcBase::$packageDir . "autoload/";]]></body>
  </line>
  <line lineNumber="251" executed="-3">
    <body><![CDATA[        ]]></body>
  </line>
  <line lineNumber="252" executed="-3">
    <body><![CDATA[        // We need the full path to the fileName. The method file_exists() doesn't]]></body>
  </line>
  <line lineNumber="253" executed="-3">
    <body><![CDATA[        // automatically check the (php.ini) library paths. Therefore:]]></body>
  </line>
  <line lineNumber="254" executed="-3">
    <body><![CDATA[        // file_exists( "ezc/autoload/$fileName" ) doesn't work.]]></body>
  </line>
  <line lineNumber="255" executed="-1">
    <body><![CDATA[        if ( $prefix === 'ezc' && file_exists( "$autoloadDir$fileName" ) )]]></body>
  </line>
  <line lineNumber="256" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="257" executed="-1">
    <body><![CDATA[            $array = require( "$autoloadDir$fileName" );]]></body>
  </line>
  <line lineNumber="258" executed="-3">
    <body></body>
  </line>
  <line lineNumber="259" executed="-1">
    <body><![CDATA[            if ( is_array( $array) && array_key_exists( $className, $array ) )]]></body>
  </line>
  <line lineNumber="260" executed="-1">
    <body><![CDATA[            {]]></body>
  </line>
  <line lineNumber="261" executed="-3">
    <body><![CDATA[                // Add the array to the cache, and include the requested file.]]></body>
  </line>
  <line lineNumber="262" executed="-1">
    <body><![CDATA[                ezcBase::$autoloadArray = array_merge( ezcBase::$autoloadArray, $array );]]></body>
  </line>
  <line lineNumber="263" executed="-1">
    <body><![CDATA[                if ( ezcBase::$options !== null && ezcBase::$options->preload && !preg_match( '/Exception$/', $className ) )]]></body>
  </line>
  <line lineNumber="264" executed="-1">
    <body><![CDATA[                {]]></body>
  </line>
  <line lineNumber="265" executed="-1">
    <body><![CDATA[                    foreach ( $array as $loadClassName => $file )]]></body>
  </line>
  <line lineNumber="266" executed="-3">
    <body><![CDATA[                    {]]></body>
  </line>
  <line lineNumber="267" executed="-1">
    <body><![CDATA[                        if ( $loadClassName !== 'ezcBase' && !class_exists( $loadClassName, false ) && !interface_exists( $loadClassName, false ) && !preg_match( '/Exception$/', $loadClassName ) /*&& !class_exists( $loadClassName, false ) && !interface_exists( $loadClassName, false )*/ )]]></body>
  </line>
  <line lineNumber="268" executed="-1">
    <body><![CDATA[                        {]]></body>
  </line>
  <line lineNumber="269" executed="-1">
    <body><![CDATA[                            ezcBase::loadFile( ezcBase::$autoloadArray[$loadClassName] );]]></body>
  </line>
  <line lineNumber="270" executed="-1">
    <body><![CDATA[                        }]]></body>
  </line>
  <line lineNumber="271" executed="-1">
    <body><![CDATA[                    }]]></body>
  </line>
  <line lineNumber="272" executed="-1">
    <body><![CDATA[                }]]></body>
  </line>
  <line lineNumber="273" executed="-3">
    <body><![CDATA[                else]]></body>
  </line>
  <line lineNumber="274" executed="-3">
    <body><![CDATA[                {]]></body>
  </line>
  <line lineNumber="275" executed="-1">
    <body><![CDATA[                    ezcBase::loadFile( ezcBase::$autoloadArray[$className] );]]></body>
  </line>
  <line lineNumber="276" executed="-3">
    <body><![CDATA[                }]]></body>
  </line>
  <line lineNumber="277" executed="-1">
    <body><![CDATA[                return true;]]></body>
  </line>
  <line lineNumber="278" executed="-2">
    <body><![CDATA[            }]]></body>
  </line>
  <line lineNumber="279" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="280" executed="-3">
    <body></body>
  </line>
  <line lineNumber="281" executed="-3">
    <body><![CDATA[        // It is not in components autoload/ dir.]]></body>
  </line>
  <line lineNumber="282" executed="-3">
    <body><![CDATA[        // try to search in additional dirs.]]></body>
  </line>
  <line lineNumber="283" executed="-1">
    <body><![CDATA[        foreach ( ezcBase::$repositoryDirs as $repositoryPrefix => $extraDir )]]></body>
  </line>
  <line lineNumber="284" executed="-3">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="285" executed="-1">
    <body><![CDATA[            if ( gettype( $repositoryPrefix ) === 'string' && $repositoryPrefix !== $prefix )]]></body>
  </line>
  <line lineNumber="286" executed="-1">
    <body><![CDATA[            {]]></body>
  </line>
  <line lineNumber="287" executed="-1">
    <body><![CDATA[                continue;]]></body>
  </line>
  <line lineNumber="288" executed="-2">
    <body><![CDATA[            }]]></body>
  </line>
  <line lineNumber="289" executed="-3">
    <body></body>
  </line>
  <line lineNumber="290" executed="-1">
    <body><![CDATA[            if ( file_exists( $extraDir['autoloadDirPath'] . '/' . $fileName ) )]]></body>
  </line>
  <line lineNumber="291" executed="-1">
    <body><![CDATA[            {]]></body>
  </line>
  <line lineNumber="292" executed="-1">
    <body><![CDATA[                $array = array();]]></body>
  </line>
  <line lineNumber="293" executed="-1">
    <body><![CDATA[                $originalArray = require( $extraDir['autoloadDirPath'] . '/' . $fileName );]]></body>
  </line>
  <line lineNumber="294" executed="-3">
    <body></body>
  </line>
  <line lineNumber="295" executed="-3">
    <body><![CDATA[                // Building paths.]]></body>
  </line>
  <line lineNumber="296" executed="-3">
    <body><![CDATA[                // Resulting path to class definition file consists of:]]></body>
  </line>
  <line lineNumber="297" executed="-3">
    <body><![CDATA[                // path to extra directory with autoload file + ]]></body>
  </line>
  <line lineNumber="298" executed="-3">
    <body><![CDATA[                // basePath provided for current extra directory + ]]></body>
  </line>
  <line lineNumber="299" executed="-3">
    <body><![CDATA[                // path to class definition file stored in autoload file.]]></body>
  </line>
  <line lineNumber="300" executed="-1">
    <body><![CDATA[                foreach ( $originalArray as $class => $classPath )]]></body>
  </line>
  <line lineNumber="301" executed="-3">
    <body><![CDATA[                {]]></body>
  </line>
  <line lineNumber="302" executed="-1">
    <body><![CDATA[                    $array[$class] = $extraDir['basePath'] . '/' . $classPath;]]></body>
  </line>
  <line lineNumber="303" executed="-1">
    <body><![CDATA[                }]]></body>
  </line>
  <line lineNumber="304" executed="-3">
    <body></body>
  </line>
  <line lineNumber="305" executed="-1">
    <body><![CDATA[                if ( is_array( $array ) && array_key_exists( $className, $array ) )]]></body>
  </line>
  <line lineNumber="306" executed="-1">
    <body><![CDATA[                {]]></body>
  </line>
  <line lineNumber="307" executed="-3">
    <body><![CDATA[                    // Add the array to the cache, and include the requested file.]]></body>
  </line>
  <line lineNumber="308" executed="-1">
    <body><![CDATA[                    ezcBase::$externalAutoloadArray = array_merge( ezcBase::$externalAutoloadArray, $array );]]></body>
  </line>
  <line lineNumber="309" executed="-1">
    <body><![CDATA[                    ezcBase::loadExternalFile( ezcBase::$externalAutoloadArray[$className] );]]></body>
  </line>
  <line lineNumber="310" executed="-1">
    <body><![CDATA[                    return true;]]></body>
  </line>
  <line lineNumber="311" executed="-2">
    <body><![CDATA[                }]]></body>
  </line>
  <line lineNumber="312" executed="-1">
    <body><![CDATA[            }]]></body>
  </line>
  <line lineNumber="313" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="314" executed="-3">
    <body></body>
  </line>
  <line lineNumber="315" executed="-3">
    <body><![CDATA[        // Nothing found :-(.]]></body>
  </line>
  <line lineNumber="316" executed="-1">
    <body><![CDATA[        return false;]]></body>
  </line>
  <line lineNumber="317" executed="-2">
    <body><![CDATA[    }]]></body>
  </line>
  <line lineNumber="318" executed="-3">
    <body></body>
  </line>
  <line lineNumber="319" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="320" executed="-3">
    <body><![CDATA[     * Loads, require(), the given file name. If we are in development mode,]]></body>
  </line>
  <line lineNumber="321" executed="-3">
    <body><![CDATA[     * "/src/" is inserted into the path.]]></body>
  </line>
  <line lineNumber="322" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="323" executed="-3">
    <body><![CDATA[     * @param string $file  The name of the file that should be loaded.]]></body>
  </line>
  <line lineNumber="324" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="325" executed="-3">
    <body><![CDATA[    protected static function loadFile( $file )]]></body>
  </line>
  <line lineNumber="326" executed="-3">
    <body><![CDATA[    {]]></body>
  </line>
  <line lineNumber="327" executed="-1">
    <body><![CDATA[        switch ( ezcBase::$libraryMode )]]></body>
  </line>
  <line lineNumber="328" executed="-3">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="329" executed="-1">
    <body><![CDATA[            case "devel":]]></body>
  </line>
  <line lineNumber="330" executed="-1">
    <body><![CDATA[            case "tarball":]]></body>
  </line>
  <line lineNumber="331" executed="-1">
    <body><![CDATA[                list( $first, $second ) = explode( '/', $file, 2 );]]></body>
  </line>
  <line lineNumber="332" executed="-1">
    <body><![CDATA[                $file = $first . "/src/" . $second;]]></body>
  </line>
  <line lineNumber="333" executed="-1">
    <body><![CDATA[                break;]]></body>
  </line>
  <line lineNumber="334" executed="-3">
    <body></body>
  </line>
  <line lineNumber="335" executed="-1">
    <body><![CDATA[            case "custom":]]></body>
  </line>
  <line lineNumber="336" executed="-1">
    <body><![CDATA[                list( $first, $second ) = explode( '/', $file, 2 );]]></body>
  </line>
  <line lineNumber="337" executed="-3">
    <body><![CDATA[                // Add the "src/" after the package name.]]></body>
  </line>
  <line lineNumber="338" executed="-1">
    <body><![CDATA[                if ( $first == 'Base' || $first == 'UnitTest' )]]></body>
  </line>
  <line lineNumber="339" executed="-1">
    <body><![CDATA[                {]]></body>
  </line>
  <line lineNumber="340" executed="-1">
    <body><![CDATA[                    list( $first, $second ) = explode( '/', $file, 2 );]]></body>
  </line>
  <line lineNumber="341" executed="-1">
    <body><![CDATA[                    $file = $first . "/src/" . $second;]]></body>
  </line>
  <line lineNumber="342" executed="-1">
    <body><![CDATA[                }]]></body>
  </line>
  <line lineNumber="343" executed="-3">
    <body><![CDATA[                else]]></body>
  </line>
  <line lineNumber="344" executed="-3">
    <body><![CDATA[                {]]></body>
  </line>
  <line lineNumber="345" executed="-1">
    <body><![CDATA[                    list( $first, $second, $third ) = explode( '/', $file, 3 );]]></body>
  </line>
  <line lineNumber="346" executed="-1">
    <body><![CDATA[                    $file = $first . '/' . $second . "/src/" . $third;]]></body>
  </line>
  <line lineNumber="347" executed="-3">
    <body><![CDATA[                }]]></body>
  </line>
  <line lineNumber="348" executed="-1">
    <body><![CDATA[                break;]]></body>
  </line>
  <line lineNumber="349" executed="-3">
    <body></body>
  </line>
  <line lineNumber="350" executed="-1">
    <body><![CDATA[            case "pear":]]></body>
  </line>
  <line lineNumber="351" executed="-3">
    <body><![CDATA[                /* do nothing, it's already correct */]]></body>
  </line>
  <line lineNumber="352" executed="-1">
    <body><![CDATA[                break;]]></body>
  </line>
  <line lineNumber="353" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="354" executed="-3">
    <body></body>
  </line>
  <line lineNumber="355" executed="-1">
    <body><![CDATA[        if ( file_exists( ezcBase::$packageDir . $file ) ) ]]></body>
  </line>
  <line lineNumber="356" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="357" executed="-1">
    <body><![CDATA[            require( ezcBase::$packageDir . $file );]]></body>
  </line>
  <line lineNumber="358" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="359" executed="-3">
    <body><![CDATA[        else]]></body>
  </line>
  <line lineNumber="360" executed="-3">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="361" executed="-3">
    <body><![CDATA[            // Can not be tested, because if this happens, then one of the]]></body>
  </line>
  <line lineNumber="362" executed="-3">
    <body><![CDATA[            // components has a broken autoload file.]]></body>
  </line>
  <line lineNumber="363" executed="-1">
    <body><![CDATA[            throw new ezcBaseFileNotFoundException( ezcBase::$packageDir.$file );]]></body>
  </line>
  <line lineNumber="364" executed="-3">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="365" executed="-1">
    <body><![CDATA[    }]]></body>
  </line>
  <line lineNumber="366" executed="-3">
    <body></body>
  </line>
  <line lineNumber="367" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="368" executed="-3">
    <body><![CDATA[     * Loads, require(), the given file name from an external package.]]></body>
  </line>
  <line lineNumber="369" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="370" executed="-3">
    <body><![CDATA[     * @param string $file  The name of the file that should be loaded.]]></body>
  </line>
  <line lineNumber="371" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="372" executed="-3">
    <body><![CDATA[    protected static function loadExternalFile( $file )]]></body>
  </line>
  <line lineNumber="373" executed="-3">
    <body><![CDATA[    {]]></body>
  </line>
  <line lineNumber="374" executed="-1">
    <body><![CDATA[        if ( file_exists( $file ) )]]></body>
  </line>
  <line lineNumber="375" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="376" executed="-1">
    <body><![CDATA[            require( $file );]]></body>
  </line>
  <line lineNumber="377" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="378" executed="-3">
    <body><![CDATA[        else]]></body>
  </line>
  <line lineNumber="379" executed="-3">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="380" executed="-1">
    <body><![CDATA[            throw new ezcBaseFileNotFoundException( $file );]]></body>
  </line>
  <line lineNumber="381" executed="-3">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="382" executed="-1">
    <body><![CDATA[    }]]></body>
  </line>
  <line lineNumber="383" executed="-3">
    <body></body>
  </line>
  <line lineNumber="384" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="385" executed="-3">
    <body><![CDATA[     * Checks for dependencies on PHP versions or extensions]]></body>
  </line>
  <line lineNumber="386" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="387" executed="-3">
    <body><![CDATA[     * The function as called by the $component component checks for the $type]]></body>
  </line>
  <line lineNumber="388" executed="-3">
    <body><![CDATA[     * dependency. The dependency $type is compared against the $value. The]]></body>
  </line>
  <line lineNumber="389" executed="-3">
    <body><![CDATA[     * function aborts the script if the dependency is not matched.]]></body>
  </line>
  <line lineNumber="390" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="391" executed="-3">
    <body><![CDATA[     * @param string $component]]></body>
  </line>
  <line lineNumber="392" executed="-3">
    <body><![CDATA[     * @param int $type]]></body>
  </line>
  <line lineNumber="393" executed="-3">
    <body><![CDATA[     * @param mixed $value]]></body>
  </line>
  <line lineNumber="394" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="395" executed="-3">
    <body><![CDATA[    public static function checkDependency( $component, $type, $value )]]></body>
  </line>
  <line lineNumber="396" executed="-3">
    <body><![CDATA[    {]]></body>
  </line>
  <line lineNumber="397" executed="-3">
    <body><![CDATA[        switch ( $type )]]></body>
  </line>
  <line lineNumber="398" executed="-3">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="399" executed="-1">
    <body><![CDATA[            case self::DEP_PHP_EXTENSION:]]></body>
  </line>
  <line lineNumber="400" executed="-1">
    <body><![CDATA[                if ( extension_loaded( $value ) )]]></body>
  </line>
  <line lineNumber="401" executed="-1">
    <body><![CDATA[                {]]></body>
  </line>
  <line lineNumber="402" executed="-1">
    <body><![CDATA[                    return;]]></body>
  </line>
  <line lineNumber="403" executed="-2">
    <body><![CDATA[                }]]></body>
  </line>
  <line lineNumber="404" executed="-3">
    <body><![CDATA[                else]]></body>
  </line>
  <line lineNumber="405" executed="-3">
    <body><![CDATA[                {]]></body>
  </line>
  <line lineNumber="406" executed="-3">
    <body><![CDATA[                    // Can not be tested as it would abort the PHP script.]]></body>
  </line>
  <line lineNumber="407" executed="-1">
    <body><![CDATA[                    die( "\nThe {$component} component depends on the default PHP extension '{$value}', which is not loaded.\n" );]]></body>
  </line>
  <line lineNumber="408" executed="-3">
    <body><![CDATA[                }]]></body>
  </line>
  <line lineNumber="409" executed="-2">
    <body><![CDATA[                break;]]></body>
  </line>
  <line lineNumber="410" executed="-3">
    <body></body>
  </line>
  <line lineNumber="411" executed="-1">
    <body><![CDATA[            case self::DEP_PHP_VERSION:]]></body>
  </line>
  <line lineNumber="412" executed="-1">
    <body><![CDATA[                $phpVersion = phpversion();]]></body>
  </line>
  <line lineNumber="413" executed="-1">
    <body><![CDATA[                if ( version_compare( $phpVersion, $value, '>=' ) )]]></body>
  </line>
  <line lineNumber="414" executed="-1">
    <body><![CDATA[                {]]></body>
  </line>
  <line lineNumber="415" executed="-1">
    <body><![CDATA[                    return;]]></body>
  </line>
  <line lineNumber="416" executed="-2">
    <body><![CDATA[                }]]></body>
  </line>
  <line lineNumber="417" executed="-3">
    <body><![CDATA[                else]]></body>
  </line>
  <line lineNumber="418" executed="-3">
    <body><![CDATA[                {]]></body>
  </line>
  <line lineNumber="419" executed="-3">
    <body><![CDATA[                    // Can not be tested as it would abort the PHP script.]]></body>
  </line>
  <line lineNumber="420" executed="-1">
    <body><![CDATA[                    die( "\nThe {$component} component depends on the PHP version '{$value}', but the current version is '{$phpVersion}'.\n" );]]></body>
  </line>
  <line lineNumber="421" executed="-3">
    <body><![CDATA[                }]]></body>
  </line>
  <line lineNumber="422" executed="-2">
    <body><![CDATA[                break;]]></body>
  </line>
  <line lineNumber="423" executed="-2">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="424" executed="-1">
    <body><![CDATA[    }]]></body>
  </line>
  <line lineNumber="425" executed="-3">
    <body></body>
  </line>
  <line lineNumber="426" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="427" executed="-3">
    <body><![CDATA[     * Return the list of directories that contain class repositories.]]></body>
  </line>
  <line lineNumber="428" executed="-3">
    <body><![CDATA[     * ]]></body>
  </line>
  <line lineNumber="429" executed="-3">
    <body><![CDATA[     * The path to the eZ components directory is always included in the result]]></body>
  </line>
  <line lineNumber="430" executed="-3">
    <body><![CDATA[     * array. Each element in the returned array has the format of:]]></body>
  </line>
  <line lineNumber="431" executed="-3">
    <body><![CDATA[     * packageDirectory => ezcBaseRepositoryDirectory]]></body>
  </line>
  <line lineNumber="432" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="433" executed="-3">
    <body><![CDATA[     * @return array(string=>ezcBaseRepositoryDirectory)]]></body>
  </line>
  <line lineNumber="434" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="435" executed="-3">
    <body><![CDATA[    public static function getRepositoryDirectories()]]></body>
  </line>
  <line lineNumber="436" executed="-3">
    <body><![CDATA[    {]]></body>
  </line>
  <line lineNumber="437" executed="-1">
    <body><![CDATA[        $autoloadDirs = array();]]></body>
  </line>
  <line lineNumber="438" executed="-1">
    <body><![CDATA[        ezcBase::setPackageDir();]]></body>
  </line>
  <line lineNumber="439" executed="-1">
    <body><![CDATA[        $repositoryDir = self::$currentWorkingDirectory ? self::$currentWorkingDirectory : ( realpath( dirname( __FILE__ ) . '/../../' ) );]]></body>
  </line>
  <line lineNumber="440" executed="-1">
    <body><![CDATA[        $autoloadDirs['ezc'] = new ezcBaseRepositoryDirectory( ezcBaseRepositoryDirectory::TYPE_INTERNAL, $repositoryDir, $repositoryDir . "/autoload" );]]></body>
  </line>
  <line lineNumber="441" executed="-3">
    <body></body>
  </line>
  <line lineNumber="442" executed="-1">
    <body><![CDATA[        foreach ( ezcBase::$repositoryDirs as $extraDirKey => $extraDirArray )]]></body>
  </line>
  <line lineNumber="443" executed="-3">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="444" executed="-1">
    <body><![CDATA[            $repositoryDirectory = new ezcBaseRepositoryDirectory( ezcBaseRepositoryDirectory::TYPE_EXTERNAL, realpath( $extraDirArray['basePath'] ), realpath( $extraDirArray['autoloadDirPath'] ) );]]></body>
  </line>
  <line lineNumber="445" executed="-1">
    <body><![CDATA[            $autoloadDirs[$extraDirKey] = $repositoryDirectory;]]></body>
  </line>
  <line lineNumber="446" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="447" executed="-3">
    <body><![CDATA[        ]]></body>
  </line>
  <line lineNumber="448" executed="-1">
    <body><![CDATA[        return $autoloadDirs;]]></body>
  </line>
  <line lineNumber="449" executed="-2">
    <body><![CDATA[    }]]></body>
  </line>
  <line lineNumber="450" executed="-3">
    <body></body>
  </line>
  <line lineNumber="451" executed="-3">
    <body><![CDATA[    /**]]></body>
  </line>
  <line lineNumber="452" executed="-3">
    <body><![CDATA[     * Adds an additional class repository.]]></body>
  </line>
  <line lineNumber="453" executed="-3">
    <body><![CDATA[     * ]]></body>
  </line>
  <line lineNumber="454" executed="-3">
    <body><![CDATA[     * Used for adding class repositoryies outside the eZ components to be]]></body>
  </line>
  <line lineNumber="455" executed="-3">
    <body><![CDATA[     * loaded by the autoload system.]]></body>
  </line>
  <line lineNumber="456" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="457" executed="-3">
    <body><![CDATA[     * This function takes two arguments: $basePath is the base path for the]]></body>
  </line>
  <line lineNumber="458" executed="-3">
    <body><![CDATA[     * whole class repository and $autoloadDirPath the path where autoload]]></body>
  </line>
  <line lineNumber="459" executed="-3">
    <body><![CDATA[     * files for this repository are found. The paths in the autoload files are]]></body>
  </line>
  <line lineNumber="460" executed="-3">
    <body><![CDATA[     * relative to the package directory as specified by the $basePath]]></body>
  </line>
  <line lineNumber="461" executed="-3">
    <body><![CDATA[     * argument. I.e. class definition file will be searched at location]]></body>
  </line>
  <line lineNumber="462" executed="-3">
    <body><![CDATA[     * $basePath + path to the class definition file as stored in the autoload]]></body>
  </line>
  <line lineNumber="463" executed="-3">
    <body><![CDATA[     * file.]]></body>
  </line>
  <line lineNumber="464" executed="-3">
    <body><![CDATA[     * ]]></body>
  </line>
  <line lineNumber="465" executed="-3">
    <body><![CDATA[     * addClassRepository() should be called somewhere in code before external classes ]]></body>
  </line>
  <line lineNumber="466" executed="-3">
    <body><![CDATA[     * are used.]]></body>
  </line>
  <line lineNumber="467" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="468" executed="-3">
    <body><![CDATA[     * Example:]]></body>
  </line>
  <line lineNumber="469" executed="-3">
    <body><![CDATA[     * Take the following facts:]]></body>
  </line>
  <line lineNumber="470" executed="-3">
    <body><![CDATA[     * <ul>]]></body>
  </line>
  <line lineNumber="471" executed="-3">
    <body><![CDATA[     * <li>there is a class repository stored in the directory "./repos"</li>]]></body>
  </line>
  <line lineNumber="472" executed="-3">
    <body><![CDATA[     * <li>autoload files for that repository are stored in "./repos/autoloads"</li>]]></body>
  </line>
  <line lineNumber="473" executed="-3">
    <body><![CDATA[     * <li>there are two components in this repository: "Me" and "You"</li>]]></body>
  </line>
  <line lineNumber="474" executed="-3">
    <body><![CDATA[     * <li>the "Me" component has the classes "erMyClass1" and "erMyClass2"</li>]]></body>
  </line>
  <line lineNumber="475" executed="-3">
    <body><![CDATA[     * <li>the "You" component has the classes "erYourClass1" and "erYourClass2"</li>]]></body>
  </line>
  <line lineNumber="476" executed="-3">
    <body><![CDATA[     * </ul>]]></body>
  </line>
  <line lineNumber="477" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="478" executed="-3">
    <body><![CDATA[     * In this case you would need to create the following files in]]></body>
  </line>
  <line lineNumber="479" executed="-3">
    <body><![CDATA[     * "./repos/autoloads". Please note that the part before _autoload.php in]]></body>
  </line>
  <line lineNumber="480" executed="-3">
    <body><![CDATA[     * the filename is the first part of the <b>classname</b>, not considering]]></body>
  </line>
  <line lineNumber="481" executed="-3">
    <body><![CDATA[     * the all lower-case letter prefix.]]></body>
  </line>
  <line lineNumber="482" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="483" executed="-3">
    <body><![CDATA[     * "my_autoload.php":]]></body>
  </line>
  <line lineNumber="484" executed="-3">
    <body><![CDATA[     * <code>]]></body>
  </line>
  <line lineNumber="485" executed="-3">
    <body><![CDATA[     * <?php]]></body>
  </line>
  <line lineNumber="486" executed="-3">
    <body><![CDATA[     *     return array (]]></body>
  </line>
  <line lineNumber="487" executed="-3">
    <body><![CDATA[     *       'erMyClass1' => 'Me/myclass1.php',]]></body>
  </line>
  <line lineNumber="488" executed="-3">
    <body><![CDATA[     *       'erMyClass2' => 'Me/myclass2.php',]]></body>
  </line>
  <line lineNumber="489" executed="-3">
    <body><![CDATA[     *     );]]></body>
  </line>
  <line lineNumber="490" executed="-3">
    <body><![CDATA[     * ?>]]></body>
  </line>
  <line lineNumber="491" executed="-3">
    <body><![CDATA[     * </code>]]></body>
  </line>
  <line lineNumber="492" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="493" executed="-3">
    <body><![CDATA[     * "your_autoload.php":]]></body>
  </line>
  <line lineNumber="494" executed="-3">
    <body><![CDATA[     * <code>]]></body>
  </line>
  <line lineNumber="495" executed="-3">
    <body><![CDATA[     * <?php]]></body>
  </line>
  <line lineNumber="496" executed="-3">
    <body><![CDATA[     *     return array (]]></body>
  </line>
  <line lineNumber="497" executed="-3">
    <body><![CDATA[     *       'erYourClass1' => 'You/yourclass1.php',]]></body>
  </line>
  <line lineNumber="498" executed="-3">
    <body><![CDATA[     *       'erYourClass2' => 'You/yourclass2.php',]]></body>
  </line>
  <line lineNumber="499" executed="-3">
    <body><![CDATA[     *     );]]></body>
  </line>
  <line lineNumber="500" executed="-3">
    <body><![CDATA[     * ?>]]></body>
  </line>
  <line lineNumber="501" executed="-3">
    <body><![CDATA[     * </code>]]></body>
  </line>
  <line lineNumber="502" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="503" executed="-3">
    <body><![CDATA[     * The directory structure for the external repository is then:]]></body>
  </line>
  <line lineNumber="504" executed="-3">
    <body><![CDATA[     * <code>]]></body>
  </line>
  <line lineNumber="505" executed="-3">
    <body><![CDATA[     * ./repos/autoloads/my_autoload.php]]></body>
  </line>
  <line lineNumber="506" executed="-3">
    <body><![CDATA[     * ./repos/autoloads/you_autoload.php]]></body>
  </line>
  <line lineNumber="507" executed="-3">
    <body><![CDATA[     * ./repos/Me/myclass1.php]]></body>
  </line>
  <line lineNumber="508" executed="-3">
    <body><![CDATA[     * ./repos/Me/myclass2.php]]></body>
  </line>
  <line lineNumber="509" executed="-3">
    <body><![CDATA[     * ./repos/You/yourclass1.php]]></body>
  </line>
  <line lineNumber="510" executed="-3">
    <body><![CDATA[     * ./repos/You/yourclass2.php]]></body>
  </line>
  <line lineNumber="511" executed="-3">
    <body><![CDATA[     * </code>]]></body>
  </line>
  <line lineNumber="512" executed="-3">
    <body><![CDATA[     *]]></body>
  </line>
  <line lineNumber="513" executed="-3">
    <body><![CDATA[     * To use this repository with the autoload mechanism you have to use the]]></body>
  </line>
  <line lineNumber="514" executed="-3">
    <body><![CDATA[     * following code:]]></body>
  </line>
  <line lineNumber="515" executed="-3">
    <body><![CDATA[     * <code>]]></body>
  </line>
  <line lineNumber="516" executed="-3">
    <body><![CDATA[     * <?php]]></body>
  </line>
  <line lineNumber="517" executed="-3">
    <body><![CDATA[     * ezcBase::addClassRepository( './repos', './repos/autoloads' );]]></body>
  </line>
  <line lineNumber="518" executed="-3">
    <body><![CDATA[     * $myVar = new erMyClass2();]]></body>
  </line>
  <line lineNumber="519" executed="-3">
    <body><![CDATA[     * ?>]]></body>
  </line>
  <line lineNumber="520" executed="-3">
    <body><![CDATA[     * </code>]]></body>
  </line>
  <line lineNumber="521" executed="-3">
    <body><![CDATA[     * ]]></body>
  </line>
  <line lineNumber="522" executed="-3">
    <body><![CDATA[     * @throws ezcBaseFileNotFoundException if $autoloadDirPath or $basePath do not exist.]]></body>
  </line>
  <line lineNumber="523" executed="-3">
    <body><![CDATA[     * @param string $basePath]]></body>
  </line>
  <line lineNumber="524" executed="-3">
    <body><![CDATA[     * @param string $autoloadDirPath]]></body>
  </line>
  <line lineNumber="525" executed="-3">
    <body><![CDATA[     * @param string $prefix]]></body>
  </line>
  <line lineNumber="526" executed="-3">
    <body><![CDATA[     */]]></body>
  </line>
  <line lineNumber="527" executed="-3">
    <body><![CDATA[    public static function addClassRepository( $basePath, $autoloadDirPath = null, $prefix = null )]]></body>
  </line>
  <line lineNumber="528" executed="-3">
    <body><![CDATA[    {]]></body>
  </line>
  <line lineNumber="529" executed="-3">
    <body><![CDATA[        // check if base path exists]]></body>
  </line>
  <line lineNumber="530" executed="-1">
    <body><![CDATA[        if ( !is_dir( $basePath ) ) ]]></body>
  </line>
  <line lineNumber="531" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="532" executed="-1">
    <body><![CDATA[            throw new ezcBaseFileNotFoundException( $basePath, 'base directory' );]]></body>
  </line>
  <line lineNumber="533" executed="-2">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="534" executed="-3">
    <body></body>
  </line>
  <line lineNumber="535" executed="-3">
    <body><![CDATA[        // calculate autoload path if it wasn't given]]></body>
  </line>
  <line lineNumber="536" executed="-1">
    <body><![CDATA[        if ( is_null( $autoloadDirPath ) )]]></body>
  </line>
  <line lineNumber="537" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="538" executed="-1">
    <body><![CDATA[            $autoloadDirPath = $basePath . '/autoload';]]></body>
  </line>
  <line lineNumber="539" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="540" executed="-3">
    <body></body>
  </line>
  <line lineNumber="541" executed="-3">
    <body><![CDATA[        // check if autoload dir exists]]></body>
  </line>
  <line lineNumber="542" executed="-1">
    <body><![CDATA[        if ( !is_dir( $autoloadDirPath ) ) ]]></body>
  </line>
  <line lineNumber="543" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="544" executed="-1">
    <body><![CDATA[            throw new ezcBaseFileNotFoundException( $autoloadDirPath, 'autoload directory' );]]></body>
  </line>
  <line lineNumber="545" executed="-2">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="546" executed="-3">
    <body></body>
  </line>
  <line lineNumber="547" executed="-3">
    <body><![CDATA[        // add info to $repositoryDirs]]></body>
  </line>
  <line lineNumber="548" executed="-1">
    <body><![CDATA[        if ( $prefix === null )]]></body>
  </line>
  <line lineNumber="549" executed="-1">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="550" executed="-1">
    <body><![CDATA[            $array = array( 'basePath' => $basePath, 'autoloadDirPath' => $autoloadDirPath );]]></body>
  </line>
  <line lineNumber="551" executed="-3">
    <body><![CDATA[ ]]></body>
  </line>
  <line lineNumber="552" executed="-3">
    <body><![CDATA[            // add info to the list of extra dirs]]></body>
  </line>
  <line lineNumber="553" executed="-1">
    <body><![CDATA[            ezcBase::$repositoryDirs[] = $array;]]></body>
  </line>
  <line lineNumber="554" executed="-1">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="555" executed="-3">
    <body><![CDATA[        else]]></body>
  </line>
  <line lineNumber="556" executed="-3">
    <body><![CDATA[        {]]></body>
  </line>
  <line lineNumber="557" executed="-1">
    <body><![CDATA[            if ( array_key_exists( $prefix, ezcBase::$repositoryDirs ) )]]></body>
  </line>
  <line lineNumber="558" executed="-1">
    <body><![CDATA[            {]]></body>
  </line>
  <line lineNumber="559" executed="-1">
    <body><![CDATA[                throw new ezcBaseDoubleClassRepositoryPrefixException( $prefix, $basePath, $autoloadDirPath );]]></body>
  </line>
  <line lineNumber="560" executed="-2">
    <body><![CDATA[            }]]></body>
  </line>
  <line lineNumber="561" executed="-3">
    <body><![CDATA[ ]]></body>
  </line>
  <line lineNumber="562" executed="-3">
    <body><![CDATA[            // add info to the list of extra dirs, and use the prefix to identify the new repository.]]></body>
  </line>
  <line lineNumber="563" executed="-1">
    <body><![CDATA[            ezcBase::$repositoryDirs[$prefix] = array( 'basePath' => $basePath, 'autoloadDirPath' => $autoloadDirPath );]]></body>
  </line>
  <line lineNumber="564" executed="-3">
    <body><![CDATA[        }]]></body>
  </line>
  <line lineNumber="565" executed="-1">
    <body><![CDATA[    }]]></body>
  </line>
  <line lineNumber="566" executed="-3">
    <body><![CDATA[}]]></body>
  </line>
  <line lineNumber="567" executed="-3">
    <body><![CDATA[?>]]></body>
  </line>
</coveredFile>
